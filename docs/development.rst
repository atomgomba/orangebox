Development
^^^^^^^^^^^

For development you can use a virtual environment and install the package in "editable" mode.

::

    # fetch the source
    git clone <repository-url> orangebox

    # create and activate virtual environment
    cd orangebox
    python3 -m venv env
    . env/bin/activate

    # install orangebox for development in the active environment
    python -m pip install --editable .

If you wish to remove the development install and keep the virtual env you can uninstall it:

::

    $ python -m pip uninstall orangebox --require-virtualenv --yes

Development tools
~~~~~~~~~~~~~~~~~

You can use `parser_test.py` to test against a CSV file generated by `blackbox-tools <https://github.com/cleanflight/blackbox-tools>`_ or `Blackbox Log Viewer <https://github.com/betaflight/blackbox-log-viewer>`_. It compares the decoded values to the ones in the CSV file and shows the differences with some additional info.

Please note that `blackbox_decode` and exporting from Blackbox Log Viewer can produce different results. This is probably due to  `blackbox_decode` is now less frequently maintained.

::

    usage: parser_test.py [-h] [-i LOG_INDEX] [-a] [-v] path csv_path

    positional arguments:
      path                  Path to a .BFL file
      csv_path              Path to a .CSV file for verification

    optional arguments:
      -h, --help            show this help message and exit
      -i LOG_INDEX, --index LOG_INDEX
                            Log index number (In case of merged input) (default: 1)
      -a, --show-all-fields
                            Show all fields of differing frames (default: False)
      -v                    Control verbosity (can be used multiple times) (default: 0)

To profile or measure the parser's execution you can use `parser_benchmark.py` and `parser_profile.py` with a single argument that's a path to a BFL file:

::

    $ python3 parser_benchmark.py ~/logs/LOG00042.BFL

